---
number: 17424
title: v-close-popup directive doesn't work within quasar vite-plugin externalized libraries
type: bug
state: open
created: 2024-08-07
url: "https://github.com/quasarframework/quasar/issues/17424"
reactions: 5
comments: 2
labels: "[kind/bug , bug/0-needs-info, Qv2 , flavour/vue-cli-plugin, area/directives]"
---

# v-close-popup directive doesn't work within quasar vite-plugin externalized libraries

### What happened?

We are developing a standalone component library for our application that is effectively wrapper components around quasar components which will be used in our set of applications.

What we have discovered is that when Vite is bundling quasar into the library's output build artifacts, there are files that the quasar library uses to track internal caches of "portal" objects so that `v-close-popup` can look through said cache and close a given portal.

However, because the caches are not designed in a way to come from a separate package, it seems that module resolution across the component library and the app using the library end up with different caches when resolving the paths of these files.
Specifically, the in-memory cache used here named `portalProxyList` https://github.com/quasarframework/quasar/blob/dev/ui/src/utils/private.portal/portal.js#L3

Externalizing quasar in our vite config doesn't resolve the issue so we are at loss for what we could do on our end

Our vite.config.js


...